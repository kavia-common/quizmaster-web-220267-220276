{"is_source_file": true, "format": "TypeScript", "description": "This file implements a Vue/Pinia store for managing multiplayer quiz game state in a web application. It includes functionality for creating and joining game rooms, handling WebSocket communication, managing game state such as players, questions, submissions, and scores, as well as local demo fallback logic.", "external_files": ["./coins", "../utils/pools", "vue"], "external_methods": ["defineStore", "computed", "ref", "watch"], "published": ["useMultiplayerStore"], "classes": [], "methods": [{"name": "function createRoom(playerName: string): string { createRoom", "description": "Creates a new multiplayer game room, either via WebSocket backend or in demo mode, initializing the state with a new room code and player ID.", "scope": "", "scopeKind": ""}, {"name": "function joinRoom(roomCode: string, playerName: string): boolean { joinRoom", "description": "Join an existing room by code, setting up the local state, and establishing WebSocket connection if available.", "scope": "", "scopeKind": ""}, {"name": "function readyUp(ready: boolean) { readyUp", "description": "Toggle and notify the server or local demo state indicating the player's readiness.", "scope": "", "scopeKind": ""}, {"name": "function hostStart(category: CategoryKey) { hostStart", "description": "Host starts the game by selecting a category, generating a seed, and shuffling questions accordingly.", "scope": "", "scopeKind": ""}, {"name": "function submitAnswer(answerIndex: number) { submitAnswer", "description": "Submit an answer index for the current question, with local or server-side scoring.", "scope": "", "scopeKind": ""}, {"name": "function nextQuestion(): boolean { nextQuestion", "description": "Advance to the next question in the quiz, sync via WebSocket if applicable.", "scope": "", "scopeKind": ""}, {"name": "function fastestWinnerNameForQuestion(qIdx: number): string | null { fastestWinnerNameForQuestion", "description": "Retrieve the name of the first correct respondent for a specific question.", "scope": "", "scopeKind": ""}, {"name": "function leaveRoom() { leaveRoom", "description": "Leave the current game room, resetting local state.", "scope": "", "scopeKind": ""}, {"name": "function tryResumeFromLocal(): boolean { tryResumeFromLocal", "description": "Attempt to restore previous session state and reconnect, if possible.", "scope": "", "scopeKind": ""}, {"name": "function appendSubmissionAndScore(submission: AnswerSubmission) { appendSubmissionAndScore", "description": "Add a new answer submission and update scores based on correctness and speed.", "scope": "", "scopeKind": ""}, {"name": "function getPoolSync(category: CategoryKey): QuizQuestion[] { getPoolSync", "description": "Sync access to predefined question pools based on category.", "scope": "", "scopeKind": ""}, {"name": "function persistIdentity() { persistIdentity", "description": "Persist the player's identity info to local storage.", "scope": "", "scopeKind": ""}, {"name": "function openSocketAndHello(isRejoin = false) { openSocketAndHello", "description": "Establish WebSocket connection and perform handshake with the server.", "scope": "", "scopeKind": ""}, {"name": "function handleWsMessage(msg: WsMessage) { handleWsMessage", "description": "Handle incoming WebSocket messages, updating game state accordingly.", "scope": "", "scopeKind": ""}, {"name": "function cryptoRandomId(): string { cryptoRandomId", "description": "Generate a cryptographically secure random ID for players.", "scope": "", "scopeKind": ""}, {"name": "function loadPersisted(): Persisted | null { loadPersisted", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function randomRoomCode(): string { randomRoomCode", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function savePersisted(p: Persisted | null) { savePersisted", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function seededShuffle<T>(arr: T[], seedStr: string): T[] { seededShuffle", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["openSocketAndHello", "handleWsMessage", "seededShuffle", "localStorage.getItem", "localStorage.setItem", "localStorage.removeItem"], "search-terms": ["multiplayer store", "WebSocket quiz game", "question pooling", "score handling", "player management", "local demo fallback", "Pinia Vue store", "WebSocket connection"], "state": 2, "file_id": 20, "knowledge_revision": 90, "git_revision": "9a003968426f458c63185924f39211c3c599b555", "revision_history": [{"51": ""}, {"58": ""}, {"59": ""}, {"60": ""}, {"61": ""}, {"90": "9a003968426f458c63185924f39211c3c599b555"}], "ctags": [{"_type": "tag", "name": "AnswerSubmission", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^export type AnswerSubmission = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "FULL_POINTS", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const points = isFirst ? FULL_POINTS : REDUCED_POINTS$/", "language": "TypeScript", "kind": "constant", "scope": "appendSubmissionAndScore", "scopeKind": "function"}, {"_type": "tag", "name": "FULL_POINTS", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^export const FULL_POINTS = 10$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "MP_STORE_KEY", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^const MP_STORE_KEY = 'quizmaster:mp:session'$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "Persisted", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^type Persisted = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "Player", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^export type Player = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "REDUCED_POINTS", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^export const REDUCED_POINTS = 5$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "RoomState", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^export type RoomState = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "WS_URL", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^const WS_URL = (import.meta.env.VITE_WS_URL as string | undefined) || ''$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "WsMessage", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^type WsMessage =$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "a", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  const a = [...arr]$/", "language": "TypeScript", "kind": "constant", "scope": "seededShuffle", "scopeKind": "function"}, {"_type": "tag", "name": "alphabet", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  const alphabet = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789' \\/\\/ avoid ambiguous chars$/", "language": "TypeScript", "kind": "constant", "scope": "randomRoomCode", "scopeKind": "function"}, {"_type": "tag", "name": "answerIndex", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      answerIndex,$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "appendSubmissionAndScore", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function appendSubmissionAndScore(submission: AnswerSubmission) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "bytes", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const bytes = new Uint8Array(8)$/", "language": "TypeScript", "kind": "constant", "scope": "cryptoRandomId", "scopeKind": "function"}, {"_type": "tag", "name": "code", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const code = roomCode.toUpperCase().trim()$/", "language": "TypeScript", "kind": "constant", "scope": "joinRoom", "scopeKind": "function"}, {"_type": "tag", "name": "correct", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      correct,$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "correct", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const correct = answerIndex === question.answerIndex$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "createRoom", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function createRoom(playerName: string): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "cryptoRandomId", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function cryptoRandomId(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "exists", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const exists = state.value.submissions.find(s => s.playerId === submission.playerId && s.que/", "language": "TypeScript", "kind": "constant", "scope": "appendSubmissionAndScore", "scopeKind": "function"}, {"_type": "tag", "name": "fastestWinnerNameForQuestion", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function fastestWinnerNameForQuestion(qIdx: number): string | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "first", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const first = subs.sort((a, b) => a.ts - b.ts)[0]$/", "language": "TypeScript", "kind": "constant", "scope": "fastestWinnerNameForQuestion", "scopeKind": "function"}, {"_type": "tag", "name": "firstCorrect", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const firstCorrect = state.value.submissions$/", "language": "TypeScript", "kind": "constant", "scope": "appendSubmissionAndScore", "scopeKind": "function"}, {"_type": "tag", "name": "getPoolSync", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function getPoolSync(category: CategoryKey): QuizQuestion[] {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "handleWsMessage", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function handleWsMessage(msg: WsMessage) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "hasBackend", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  const hasBackend = computed(() => !!WS_URL)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "hello", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^        const hello: WsMessage = { type: 'HELLO', roomCode: state.value.roomCode, playerId: stat/", "language": "TypeScript", "kind": "constant", "scope": "openSocketAndHello", "scopeKind": "function"}, {"_type": "tag", "name": "hostId", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^        const hostId = cryptoRandomId()$/", "language": "TypeScript", "kind": "constant", "scope": "joinRoom", "scopeKind": "function"}, {"_type": "tag", "name": "hostStart", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function hostStart(category: CategoryKey) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const id = state.value.playerId$/", "language": "TypeScript", "kind": "constant", "scope": "leaveRoom", "scopeKind": "function"}, {"_type": "tag", "name": "isFirst", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const isFirst = firstCorrect && firstCorrect.playerId === submission.playerId$/", "language": "TypeScript", "kind": "constant", "scope": "appendSubmissionAndScore", "scopeKind": "function"}, {"_type": "tag", "name": "isHost", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const isHost = state.value.isHost$/", "language": "TypeScript", "kind": "constant", "scope": "leaveRoom", "scopeKind": "function"}, {"_type": "tag", "name": "j", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const j = Math.floor(r * (i + 1))$/", "language": "TypeScript", "kind": "constant", "scope": "seededShuffle", "scopeKind": "function"}, {"_type": "tag", "name": "joinRoom", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function joinRoom(roomCode: string, playerName: string): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "leaderboard", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  const leaderboard = computed(() => [...state.value.players].sort((a, b) => b.score - a.score))$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "leaveRoom", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function leaveRoom() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "loadPersisted", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^function loadPersisted(): Persisted | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "me", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  const me = computed(() => state.value.players.find(p => p.id === state.value.playerId) || null/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "mine", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const mine = me.value$/", "language": "TypeScript", "kind": "constant", "scope": "readyUp", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^        const msg = JSON.parse(ev.data) as WsMessage$/", "language": "TypeScript", "kind": "constant", "scope": "openSocketAndHello", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^        const msg: WsMessage = { type: 'REJOIN', roomCode: state.value.roomCode, playerId: state/", "language": "TypeScript", "kind": "constant", "scope": "openSocketAndHello", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const msg: WsMessage = { type: 'QUESTION_INDEX', index: nextIndex, questionStartTs: state./", "language": "TypeScript", "kind": "constant", "scope": "nextQuestion", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const msg: WsMessage = { type: 'READY', playerId: state.value.playerId, ready }$/", "language": "TypeScript", "kind": "constant", "scope": "readyUp", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const msg: WsMessage = { type: 'START', category, seed, questionStartTs: state.value.quest/", "language": "TypeScript", "kind": "constant", "scope": "hostStart", "scopeKind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const msg: WsMessage = { type: 'SUBMISSION', submission }$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^        const hello: WsMessage = { type: 'HELLO', roomCode: state.value.roomCode, playerId: stat/", "language": "TypeScript", "kind": "constant", "scope": "openSocketAndHello", "scopeKind": "function"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const name = state.value.playerName$/", "language": "TypeScript", "kind": "constant", "scope": "leaveRoom", "scopeKind": "function"}, {"_type": "tag", "name": "nextIndex", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const nextIndex = state.value.currentQuestionIndex + 1$/", "language": "TypeScript", "kind": "constant", "scope": "nextQuestion", "scopeKind": "function"}, {"_type": "tag", "name": "nextQuestion", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function nextQuestion(): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "openSocketAndHello", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function openSocketAndHello(isRejoin = false) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^        const p = state.value.players.find(pl => pl.id === msg.playerId)$/", "language": "TypeScript", "kind": "constant", "scope": "handleWsMessage", "scopeKind": "function"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const p = state.value.players.find(pl => pl.id === submission.playerId)$/", "language": "TypeScript", "kind": "constant", "scope": "appendSubmissionAndScore", "scopeKind": "function"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const p = JSON.parse(raw)$/", "language": "TypeScript", "kind": "constant", "scope": "loadPersisted", "scopeKind": "function"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const p = loadPersisted()$/", "language": "TypeScript", "kind": "constant", "scope": "tryResumeFromLocal", "scopeKind": "function"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const p = state.value.players.find(pl => pl.id === first.playerId)$/", "language": "TypeScript", "kind": "constant", "scope": "fastestWinnerNameForQuestion", "scopeKind": "function"}, {"_type": "tag", "name": "persistIdentity", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function persistIdentity() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "pingTimer", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^let pingTimer: number | null = null$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "playerId", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^        const hello: WsMessage = { type: 'HELLO', roomCode: state.value.roomCode, playerId: stat/", "language": "TypeScript", "kind": "constant", "scope": "openSocketAndHello", "scopeKind": "function"}, {"_type": "tag", "name": "playerId", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^        const msg: WsMessage = { type: 'REJOIN', roomCode: state.value.roomCode, playerId: state/", "language": "TypeScript", "kind": "constant", "scope": "openSocketAndHello", "scopeKind": "function"}, {"_type": "tag", "name": "playerId", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const playerId = cryptoRandomId()$/", "language": "TypeScript", "kind": "constant", "scope": "createRoom", "scopeKind": "function"}, {"_type": "tag", "name": "playerId", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const playerId = cryptoRandomId()$/", "language": "TypeScript", "kind": "constant", "scope": "joinRoom", "scopeKind": "function"}, {"_type": "tag", "name": "points", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const points = isFirst ? FULL_POINTS : REDUCED_POINTS$/", "language": "TypeScript", "kind": "constant", "scope": "appendSubmissionAndScore", "scopeKind": "function"}, {"_type": "tag", "name": "pool", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^          const pool = getPoolSync(state.value.category)$/", "language": "TypeScript", "kind": "constant", "scope": "handleWsMessage", "scopeKind": "function"}, {"_type": "tag", "name": "pool", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const pool = getPoolSync(category)$/", "language": "TypeScript", "kind": "constant", "scope": "hostStart", "scopeKind": "function"}, {"_type": "tag", "name": "pools", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const pools = poolsDefault as Record<CategoryKey, QuizQuestion[]>$/", "language": "TypeScript", "kind": "constant", "scope": "getPoolSync", "scopeKind": "function"}, {"_type": "tag", "name": "qIdx", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const qIdx = state.value.currentQuestionIndex$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "qIdx", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const question = state.value.questions[qIdx]$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "question", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const question = state.value.questions[qIdx]$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "questionIndex", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      questionIndex: qIdx,$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "questionStartTs", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const msg: WsMessage = { type: 'QUESTION_INDEX', index: nextIndex, questionStartTs: state./", "language": "TypeScript", "kind": "constant", "scope": "nextQuestion", "scopeKind": "function"}, {"_type": "tag", "name": "questionStartTs", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const msg: WsMessage = { type: 'START', category, seed, questionStartTs: state.value.quest/", "language": "TypeScript", "kind": "constant", "scope": "hostStart", "scopeKind": "function"}, {"_type": "tag", "name": "r", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const r = Math.abs(seed) \\/ 0x7fffffff$/", "language": "TypeScript", "kind": "constant", "scope": "seededShuffle", "scopeKind": "function"}, {"_type": "tag", "name": "randomRoomCode", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^function randomRoomCode(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const raw = localStorage.getItem(MP_STORE_KEY)$/", "language": "TypeScript", "kind": "constant", "scope": "loadPersisted", "scopeKind": "function"}, {"_type": "tag", "name": "ready", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const msg: WsMessage = { type: 'READY', playerId: state.value.playerId, ready }$/", "language": "TypeScript", "kind": "constant", "scope": "readyUp", "scopeKind": "function"}, {"_type": "tag", "name": "readyUp", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function readyUp(ready: boolean) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "roomCode", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const roomCode = randomRoomCode()$/", "language": "TypeScript", "kind": "constant", "scope": "createRoom", "scopeKind": "function"}, {"_type": "tag", "name": "savePersisted", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^function savePersisted(p: Persisted | null) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "seed", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      const msg: WsMessage = { type: 'START', category, seed, questionStartTs: state.value.quest/", "language": "TypeScript", "kind": "constant", "scope": "hostStart", "scopeKind": "function"}, {"_type": "tag", "name": "seed", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const seed = `${state.value.roomCode}:${category}:${Date.now()}`$/", "language": "TypeScript", "kind": "constant", "scope": "hostStart", "scopeKind": "function"}, {"_type": "tag", "name": "seededShuffle", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^function seededShuffle<T>(arr: T[], seedStr: string): T[] {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "socket", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^let socket: WebSocket | null = null$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "submission", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const submission: AnswerSubmission = {$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "submitAnswer", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function submitAnswer(answerIndex: number) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "subs", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const subs = state.value.submissions.filter(s => s.questionIndex === qIdx && s.correct)$/", "language": "TypeScript", "kind": "constant", "scope": "fastestWinnerNameForQuestion", "scopeKind": "function"}, {"_type": "tag", "name": "tryResumeFromLocal", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^  function tryResumeFromLocal(): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "ts", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^      ts,$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "ts", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const ts = Date.now()$/", "language": "TypeScript", "kind": "constant", "scope": "submitAnswer", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^    const url = WS_URL.replace(\\/\\\\\\/+$\\/, '')$/", "language": "TypeScript", "kind": "constant", "scope": "openSocketAndHello", "scopeKind": "function"}, {"_type": "tag", "name": "useMultiplayerStore", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/multiplayer.ts", "pattern": "/^export const useMultiplayerStore = defineStore('multiplayer', () => {$/", "language": "TypeScript", "kind": "constant"}], "hash": "b9c377ad31c980f29100d553b7b7ddc6", "format-version": 4, "code-base-name": "quiz_game_frontend", "filename": "quiz_game_frontend/src/stores/multiplayer.ts", "fields": [{"name": "let pingTimer: number | null = null", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let socket: WebSocket | null = null", "scope": "", "scopeKind": "", "description": "unavailable"}]}
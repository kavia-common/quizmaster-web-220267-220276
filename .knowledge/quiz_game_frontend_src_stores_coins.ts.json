{"is_source_file": true, "format": "TypeScript", "description": "This file defines a Pinia store for managing in-app coin balance and history, including types, constants, and methods for loading, saving, adding, and spending coins, as well as utility functions for generating idempotency keys.", "external_files": ["pinia"], "external_methods": [], "published": ["useCoinsStore", "CoinIds", "ensureCoinsLoaded"], "classes": [{"name": "CoinsState", "description": "Interface representing the state of the coins store, including balance, lifetime earned, history, and version."}, {"name": "CoinHistoryItem", "description": "Interface for individual coin transaction records, including id, timestamp, delta, reason, and optional metadata."}], "methods": [{"name": "load", "description": "Loads the coin state from localStorage."}, {"name": "save", "description": "Persists the current coin state to localStorage."}, {"name": "add", "description": "Adds coins with a specified delta, reason, and id for idempotency, updating balance and history."}, {"name": "reset", "description": "Resets the coin store to initial state; mainly used for development or testing."}, {"name": "spend", "description": "Attempts to spend a specified amount of coins if sufficient balance exists."}, {"name": "export function ensureCoinsLoaded(): void { ensureCoinsLoaded", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function nowTs(): number { nowTs", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function safeParse<T>(raw: string | null): T | null { safeParse", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["date.now()", "localStorage.getItem()", "localStorage.setItem()"], "search-terms": ["Pinia coin store", "CoinsState interface", "coin history management", "idempotent coin rewards", "localStorage persistence", "CoinIds utility", "coins balance and lifetime"], "state": 2, "file_id": 28, "knowledge_revision": 89, "git_revision": "", "ctags": [{"_type": "tag", "name": "COIN_RULES", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^export const COIN_RULES = {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "CoinHistoryItem", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^export interface CoinHistoryItem {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "CoinReason", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^export type CoinReason =$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "CoinsState", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^export interface CoinsState {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^const STORAGE_KEY = 'coins.v1'$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "_version", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  _version: number$/", "language": "TypeScript", "kind": "property", "scope": "CoinsState", "scopeKind": "interface"}, {"_type": "tag", "name": "balance", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  balance: number$/", "language": "TypeScript", "kind": "property", "scope": "CoinsState", "scopeKind": "interface"}, {"_type": "tag", "name": "delta", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  delta: number$/", "language": "TypeScript", "kind": "property", "scope": "CoinHistoryItem", "scopeKind": "interface"}, {"_type": "tag", "name": "ensureCoinsLoaded", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^export function ensureCoinsLoaded(): void {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "history", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  history: CoinHistoryItem[]$/", "language": "TypeScript", "kind": "property", "scope": "CoinsState", "scopeKind": "interface"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  id: string \\/\\/ idempotency key to prevent duplicates$/", "language": "TypeScript", "kind": "property", "scope": "CoinHistoryItem", "scopeKind": "interface"}, {"_type": "tag", "name": "item", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^      const item: CoinHistoryItem = {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "lifetimeEarned", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  lifetimeEarned: number$/", "language": "TypeScript", "kind": "property", "scope": "CoinsState", "scopeKind": "interface"}, {"_type": "tag", "name": "meta", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  meta?: Record<string, string | number>$/", "language": "TypeScript", "kind": "property", "scope": "CoinHistoryItem", "scopeKind": "interface"}, {"_type": "tag", "name": "nowTs", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^function nowTs(): number {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "reason", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  reason: CoinReason$/", "language": "TypeScript", "kind": "property", "scope": "CoinHistoryItem", "scopeKind": "interface"}, {"_type": "tag", "name": "safeParse", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^function safeParse<T>(raw: string | null): T | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "store", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  const store = useCoinsStore()$/", "language": "TypeScript", "kind": "constant", "scope": "ensureCoinsLoaded", "scopeKind": "function"}, {"_type": "tag", "name": "ts", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^        ts: nowTs(),$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "ts", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^  ts: number$/", "language": "TypeScript", "kind": "property", "scope": "CoinHistoryItem", "scopeKind": "interface"}, {"_type": "tag", "name": "useCoinsStore", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/coins.ts", "pattern": "/^export const useCoinsStore = defineStore('coins', {$/", "language": "TypeScript", "kind": "constant"}], "hash": "77e426db7d8c9300fc4d529cf4997285", "format-version": 4, "code-base-name": "quiz_game_frontend", "filename": "quiz_game_frontend/src/stores/coins.ts", "fields": [{"name": "export interface CoinHistoryItem {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "export interface CoinsState {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_version: number", "scope": "CoinsState", "scopeKind": "interface", "description": "unavailable"}, {"name": "balance: number", "scope": "CoinsState", "scopeKind": "interface", "description": "unavailable"}, {"name": "delta: number", "scope": "CoinHistoryItem", "scopeKind": "interface", "description": "unavailable"}, {"name": "history: CoinHistoryItem[]", "scope": "CoinsState", "scopeKind": "interface", "description": "unavailable"}, {"name": "id: string \\/\\/ idempotency key to prevent duplicates", "scope": "CoinHistoryItem", "scopeKind": "interface", "description": "unavailable"}, {"name": "lifetimeEarned: number", "scope": "CoinsState", "scopeKind": "interface", "description": "unavailable"}, {"name": "meta?: Record<string, string | number>", "scope": "CoinHistoryItem", "scopeKind": "interface", "description": "unavailable"}, {"name": "reason: CoinReason", "scope": "CoinHistoryItem", "scopeKind": "interface", "description": "unavailable"}, {"name": "ts: number", "scope": "CoinHistoryItem", "scopeKind": "interface", "description": "unavailable"}], "revision_history": [{"89": ""}]}
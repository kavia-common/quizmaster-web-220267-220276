{"is_source_file": true, "format": "TypeScript", "description": "This file defines a Pinia store for managing tournament state in a Vue.js front-end application. It includes state variables, functions to load and save persistent state, actions to start and progress through tournament rounds, and logic for computing medals and coins based on performance.", "external_files": ["./quiz", "./coins", "@/utils/pools", "./quiz", "@/utils/awards"], "external_methods": ["useCoinsStore", "ensureCoinsLoaded", "getTournamentQuestionSet", "useQuizStore", "computeMedals"], "published": ["useTournamentStore"], "classes": [], "methods": [{"name": "function seededId(): string { seededId", "description": "Generates a random seed string using crypto.getRandomValues or fallback to Math.random.", "scope": "", "scopeKind": ""}, {"name": "function now(): number { return Date.now() } now", "description": "Returns the current timestamp in milliseconds.", "scope": "", "scopeKind": ""}, {"name": "function loadPersisted(): TournamentState | null { loadPersisted", "description": "Loads persisted tournament state from localStorage, validating version compatibility.", "scope": "", "scopeKind": ""}, {"name": "function savePersisted(state: TournamentState | null): void { savePersisted", "description": "Saves the current tournament state to localStorage with versioning.", "scope": "", "scopeKind": ""}, {"name": "function defaultCurve(): DifficultyKey[] { defaultCurve", "description": "Returns a default difficulty curve array with 10 stages.", "scope": "", "scopeKind": ""}, {"name": "function fromState(s: TournamentState) { fromState", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function loadIfAvailable(): boolean { loadIfAvailable", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function persist() { savePersisted(toState()) } persist", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "async function prepareRoundQuestions(countPerRound = 10): Promise<QuizQuestion[]> { prepareRoundQuestions", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function recordRoundResult(meta: { recordRoundResult", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function resetTournament() { resetTournament", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "async function startNextRound(): Promise<{ questions: QuizQuestion[]; roundNumber: number; dif/ startNextRound", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function startTournament(opts: { category: CategoryKey | 'mixed'; seed?: string }) { startTournament", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function toState(): TournamentState { toState", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["localStorage.getItem", "localStorage.setItem", "JSON.parse", "JSON.stringify", "loadQuestions", "useQuizStore", "getTournamentQuestionSet", "ensureCoinsLoaded", "coins.add", "import('@/utils/awards').then"], "search-terms": ["tournament", "Pinia store", "difficultyCurve", "startNextRound", "recordRoundResult", "completeTournament", "persisted state", "localStorage", "question set"], "state": 2, "file_id": 31, "knowledge_revision": 112, "git_revision": "", "revision_history": [{"100": ""}, {"109": ""}, {"110": ""}, {"112": ""}], "ctags": [{"_type": "tag", "name": "DifficultyKey", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^export type DifficultyKey = 'easy' | 'medium' | 'hard'$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "Math", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const accuracyPct = totalAnswered > 0 ? Math.round((meta.correct \\/ totalAnswered) * 100) : /", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "Math", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const diff = difficultyCurve.value[Math.min(currentRound.value, difficultyCurve.value.length/", "language": "TypeScript", "kind": "constant", "scope": "prepareRoundQuestions", "scopeKind": "function"}, {"_type": "tag", "name": "Math", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const difficulty = difficultyCurve.value[Math.min(nextIndex, difficultyCurve.value.length - /", "language": "TypeScript", "kind": "constant", "scope": "startNextRound", "scopeKind": "function"}, {"_type": "tag", "name": "RoundStat", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^export type RoundStat = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^const STORAGE_KEY = 'tournament.v1'$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "STORAGE_VERSION", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^const STORAGE_VERSION = 1$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "TournamentPlayer", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^export type TournamentPlayer = { id: string; name: string; score: number }$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "TournamentState", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^export type TournamentState = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "a", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const a = new Uint8Array(8)$/", "language": "TypeScript", "kind": "constant", "scope": "seededId", "scopeKind": "function"}, {"_type": "tag", "name": "accuracyPct", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      accuracyPct,$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "accuracyPct", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const accuracyPct = totalAnswered > 0 ? Math.round((meta.correct \\/ totalAnswered) * 100) : /", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "catForPool", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const catForPool = poolCat === 'mixed' ? null : poolCat$/", "language": "TypeScript", "kind": "constant", "scope": "prepareRoundQuestions", "scopeKind": "function"}, {"_type": "tag", "name": "coins", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      const coins = useCoinsStore()$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "defaultCurve", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^function defaultCurve(): DifficultyKey[] {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "diff", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const diff = difficultyCurve.value[Math.min(currentRound.value, difficultyCurve.value.length/", "language": "TypeScript", "kind": "constant", "scope": "prepareRoundQuestions", "scopeKind": "function"}, {"_type": "tag", "name": "difficulty", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const difficulty = difficultyCurve.value[Math.min(nextIndex, difficultyCurve.value.length - /", "language": "TypeScript", "kind": "constant", "scope": "startNextRound", "scopeKind": "function"}, {"_type": "tag", "name": "durations", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      durations: meta.durations,$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "fromState", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  function fromState(s: TournamentState) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      const id = `${sessionId.value}:round:${currentRound.value + 1}`$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      const id = `${sessionId.value}:tournament-complete`$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const idx = roundStats.value.findIndex(r => r.round === rs.round)$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "loadIfAvailable", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  function loadIfAvailable(): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "loadPersisted", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^function loadPersisted(): TournamentState | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "medals", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      const medals = mod.computeMedals({$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "nextIndex", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const nextIndex = currentRound.value$/", "language": "TypeScript", "kind": "constant", "scope": "startNextRound", "scopeKind": "function"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^function now(): number { return Date.now() }$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "null", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const catForPool = poolCat === 'mixed' ? null : poolCat$/", "language": "TypeScript", "kind": "constant", "scope": "prepareRoundQuestions", "scopeKind": "function"}, {"_type": "tag", "name": "obj", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const obj = JSON.parse(raw) as { version?: number; state?: TournamentState } | TournamentSta/", "language": "TypeScript", "kind": "constant", "scope": "loadPersisted", "scopeKind": "function"}, {"_type": "tag", "name": "persist", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  function persist() { savePersisted(toState()) }$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "player", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const player = (players.value || [])[0]$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "poolCat", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const poolCat = category.value$/", "language": "TypeScript", "kind": "constant", "scope": "prepareRoundQuestions", "scopeKind": "function"}, {"_type": "tag", "name": "prepareRoundQuestions", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  async function prepareRoundQuestions(countPerRound = 10): Promise<QuizQuestion[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "questions", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const questions = await prepareRoundQuestions(10)$/", "language": "TypeScript", "kind": "constant", "scope": "startNextRound", "scopeKind": "function"}, {"_type": "tag", "name": "questions", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const questions = getTournamentQuestionSet(roundSeed, catForPool ?? undefined, diff, countPe/", "language": "TypeScript", "kind": "constant", "scope": "prepareRoundQuestions", "scopeKind": "function"}, {"_type": "tag", "name": "quiz", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const quiz = useQuizStore()$/", "language": "TypeScript", "kind": "constant", "scope": "prepareRoundQuestions", "scopeKind": "function"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const raw = localStorage.getItem(STORAGE_KEY)$/", "language": "TypeScript", "kind": "constant", "scope": "loadPersisted", "scopeKind": "function"}, {"_type": "tag", "name": "recordRoundResult", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  function recordRoundResult(meta: {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "resetTournament", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  function resetTournament() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "roundSeed", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const roundSeed = `${seed.value}:${currentRound.value + 1}`$/", "language": "TypeScript", "kind": "constant", "scope": "prepareRoundQuestions", "scopeKind": "function"}, {"_type": "tag", "name": "rs", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const rs: RoundStat = {$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "s", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const s = loadPersisted()$/", "language": "TypeScript", "kind": "constant", "scope": "loadIfAvailable", "scopeKind": "function"}, {"_type": "tag", "name": "savePersisted", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^function savePersisted(state: TournamentState | null): void {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "seededId", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^function seededId(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "skipped", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      skipped: meta.skipped,$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "startNextRound", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  async function startNextRound(): Promise<{ questions: QuizQuestion[]; roundNumber: number; dif/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "startTournament", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  function startTournament(opts: { category: CategoryKey | 'mixed'; seed?: string }) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "toState", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^  function toState(): TournamentState {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "totalAnswered", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const totalAnswered = meta.correct + meta.wrong$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "totalWrong", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^    const totalWrong = roundStats.value.reduce((s, r) => s + r.wrong, 0)$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}, {"_type": "tag", "name": "useTournamentStore", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^export const useTournamentStore = defineStore('tournament', () => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "v", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      const v = (obj as { version?: number; state?: TournamentState }).version$/", "language": "TypeScript", "kind": "constant", "scope": "loadPersisted", "scopeKind": "function"}, {"_type": "tag", "name": "wrong", "path": "/home/kavia/workspace/code-generation/quizmaster-web-220267-220276/quiz_game_frontend/src/stores/tournament.ts", "pattern": "/^      wrong: meta.wrong,$/", "language": "TypeScript", "kind": "constant", "scope": "recordRoundResult", "scopeKind": "function"}], "hash": "0783954b4edfc375c39150f7efdfec53", "format-version": 4, "code-base-name": "quiz_game_frontend", "filename": "quiz_game_frontend/src/stores/tournament.ts"}